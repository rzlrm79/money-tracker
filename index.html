<!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Money Tracker</title>
  <style>
    body { font-family: Arial, sans-serif; background:#0f172a; color:#e5e7eb; margin:0; padding:16px }
    h1 { text-align:center }
    .card { background:#020617; padding:16px; border-radius:12px; margin-bottom:12px }
    input, select, button { width:100%; padding:10px; margin-top:8px; border-radius:8px; border:none }
    button { background:#22c55e; color:#020617; font-weight:bold }
    .list { margin-top:12px }
    .item { display:flex; justify-content:space-between; margin-top:6px }
    .income { color:#22c55e }
    .expense { color:#ef4444 }
  </style>
</head>
<body>
  <h1>üí∞ Money Tracker</h1>  <div class="card">
    <h3>Saldo</h3>
    <h2 id="saldo">Rp 0</h2>
  </div>  <div class="card">
    <h3>Tambah Transaksi</h3>
    <input id="desc" placeholder="Keterangan" />
    <input id="amount" type="number" placeholder="Jumlah" />
    <select id="type">
      <option value="income">Pemasukan</option>
      <option value="expense">Pengeluaran</option>
    </select>
    <select id="category">
      <option value="Makan">üçî Makan</option>
      <option value="Transport">üöó Transport</option>
      <option value="Rumah">üè† Rumah</option>
      <option value="Gaji">üíº Gaji</option>
      <option value="Lainnya">üì¶ Lainnya</option>
    </select>
    <button onclick="addTx()">Tambah</button>
  </div>  <div class="card">
    <h3>Grafik Pengeluaran</h3>
    <div id="chart"></div>
  </div>  <div class="card list">
    <h3>Riwayat</h3>
    <div id="list"></div>
    <small>Tap = hapus ‚Ä¢ Tahan = edit</small>
  </div><script>
// pastikan grafik digambar setelah halaman siap
window.addEventListener('load', ()=>{ try{ drawChart(); }catch(e){} });
let data = JSON.parse(localStorage.getItem('money-data')||'[]');

function format(n){return 'Rp '+n.toLocaleString('id-ID')}

function render(){
  const list=document.getElementById('list');
  list.innerHTML='';
  let saldo=0;
  data.forEach((d,i)=>{
    saldo += d.type==='income'?d.amount:-d.amount;
    const div=document.createElement('div');
    div.className='item '+d.type;
    div.innerHTML=`<span>${d.desc}<br><small>${d.category}</small></span><span>${format(d.amount)}</span>`;
    div.onclick=()=>{
      if(confirm('Hapus transaksi ini?')){
        data.splice(i,1);
        render();
  drawChart();
  drawChart();
      }
    };
    div.ontouchstart=()=>{this._pressTimer=setTimeout(()=>editTx(i),600)};
    div.ontouchend=()=>clearTimeout(this._pressTimer);
    list.appendChild(div);
  });
  document.getElementById('saldo').innerText=format(saldo);
  localStorage.setItem('money-data',JSON.stringify(data));
}

function drawChart(){
  const box=document.getElementById('chart');
  if(!box) return;
  box.innerHTML='';

  const expenses=data.filter(d=>d.type==='expense');
  if(expenses.length===0){
    box.innerHTML='<small>Belum ada data pengeluaran</small>';
    return;
  }

  const map={};
  expenses.forEach(d=>{
    const cat=d.category||'Lainnya';
    map[cat]=(map[cat]||0)+d.amount;
  });

  const max=Math.max(...Object.values(map));

  Object.entries(map).forEach(([cat,val])=>{
    const row=document.createElement('div');
    row.style.margin='8px 0';

    const label=document.createElement('div');
    label.innerText=`${cat} ‚Äî Rp ${val.toLocaleString('id-ID')}`;
    label.style.fontSize='12px';

    const bar=document.createElement('div');
    bar.style.height='10px';
    bar.style.borderRadius='6px';
    bar.style.background='#22c55e';
    bar.style.width=(val/max*100)+'%';

    row.appendChild(label);
    row.appendChild(bar);
    box.appendChild(row);
  });
}

function addTx(){
  const desc=descInput.value;
  const amount=+amountInput.value;
  const type=typeSelect.value;
  if(!desc||!amount)return alert('Lengkapi data');
  const category=document.getElementById('category').value;
  data.unshift({desc,amount,type,category,date:Date.now()});
  descInput.value='';amountInput.value='';
  render();
  drawChart();
}

function editTx(i){
  const d=data[i];
  const desc=prompt('Keterangan',d.desc);
  if(desc===null)return;
  const amount=prompt('Jumlah',d.amount);
  if(amount===null)return;
  const category=prompt('Kategori',d.category||'Lainnya');
  data[i]={...d,desc,amount:+amount,category};
  render();
  drawChart();
}

const descInput=document.getElementById('desc');
const amountInput=document.getElementById('amount');
const typeSelect=document.getElementById('type');

render();
  drawChart();
</script></body>
</html>
