<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Money Tracker</title>
<style>
body{background:#020617;color:#e5e7eb;font-family:Arial;margin:0;padding:16px}
h1{text-align:center}
.card{background:#020617;border-radius:16px;padding:16px;margin-bottom:16px;box-shadow:0 0 30px #000}
input,select,button{width:100%;padding:12px;border-radius:10px;border:none;margin-top:8px}
button{background:#22c55e;font-weight:bold}
.item{display:flex;justify-content:space-between;margin-top:8px}
.income{color:#22c55e}
.expense{color:#ef4444}
.bar{height:10px;background:#22c55e;border-radius:6px}
small{opacity:.7}
</style>
</head>
<body>

<h1>ðŸ’° Money Tracker</h1>

<div class="card">
<h3>Saldo</h3>
<h2 id="saldo">Rp 0</h2>
</div>

<div class="card">
<h3>Tambah Transaksi</h3>
<input id="desc" placeholder="Keterangan">
<input id="amount" type="number" placeholder="Jumlah">
<select id="type">
<option value="income">Pemasukan</option>
<option value="expense">Pengeluaran</option>
</select>
<select id="category">
<option>Makan</option>
<option>Transport</option>
<option>Rumah</option>
<option>Gaji</option>
<option>Lainnya</option>
</select>
<button onclick="addTx()">Tambah</button>
</div>

<div class="card">
<h3>Grafik Pengeluaran</h3>
<div id="chart"></div>
</div>

<div class="card">
<h3>Riwayat</h3>
<div id="list"></div>
<small>Tap = hapus â€¢ Tahan = edit</small>
</div>

<script>
let data=JSON.parse(localStorage.getItem('money')||'[]');

function rupiah(n){return 'Rp '+n.toLocaleString('id-ID')}

function render(){
  let saldo=0,list=document.getElementById('list');
  list.innerHTML='';
  data.forEach((d,i)=>{
    saldo+=d.type==='income'?d.amount:-d.amount;
    let div=document.createElement('div');
    div.className='item '+d.type;
    div.innerHTML=`<span>${d.desc}<br><small>${d.category}</small></span><span>${rupiah(d.amount)}</span>`;
    div.onclick=()=>confirm('Hapus?')&&(data.splice(i,1),save());
    div.ontouchstart=()=>div._t=setTimeout(()=>edit(i),600);
    div.ontouchend=()=>clearTimeout(div._t);
    list.appendChild(div);
  });
  document.getElementById('saldo').innerText=rupiah(saldo);
  drawChart();
}

function drawChart(){
  let box=document.getElementById('chart');
  box.innerHTML='';
  let exp=data.filter(d=>d.type==='expense');
  if(!exp.length){box.innerHTML='<small>Belum ada pengeluaran</small>';return;}
  let map={};
  exp.forEach(d=>map[d.category]=(map[d.category]||0)+d.amount);
  let max=Math.max(...Object.values(map));
  for(let k in map){
    box.innerHTML+=`<small>${k} â€” ${rupiah(map[k])}</small>
    <div class="bar" style="width:${map[k]/max*100}%"></div>`;
  }
}

function addTx(){
  let d={desc:desc.value,amount:+amount.value,type:type.value,category:category.value};
  if(!d.desc||!d.amount)return alert('Lengkapi data');
  data.unshift(d);desc.value='';amount.value='';save();
}

function edit(i){
  let d=data[i];
  let desc=prompt('Keterangan',d.desc); if(desc===null)return;
  let amt=prompt('Jumlah',d.amount); if(amt===null)return;
  data[i]={...d,desc,amount:+amt}; save();
}

function save(){
  localStorage.setItem('money',JSON.stringify(data));
  render();
}

render();
</script>

</body>
</html>
